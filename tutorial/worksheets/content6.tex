\section*{NAIL062 P\&P Logic: Worksheet 6 -- Basics of predicate logic}
% after Lecture 6


\subsection*{Teaching goals:} After completing, the student

\begin{itemize}\setlength{\itemsep}{0pt}
    \item rozumí pojmu struktura, signatura, umí je formálně definovat a uvést příklady
    \item rozumí pojmům syntaxe predikátové logiky (jazyk, term, atomická formule, formule, teorie, volná proměnná, otevřená formule, sentence, instance, varianta) umí je formálně definovat a uvést příklady
    \item rozumí pojmům sémantiky predikátové logiky (hodnota termu, pravdivostní hodnota, platnost [při ohodnocení], model, pravdivost/lživost v modelu/v teorii, nezávislost [v teorii], důsledek teorie) umí je formálně definovat a uvést příklady
    \item rozumí pojmu kompletní teorie a jeho souvislosti s elementární ekvivalencí struktur, umí obojí definovat, aplikovat na příkladě
    \item zná základní příklady teorií (teorie grafů, uspořádání, algebraické teorie)
    \item umí popsat modely dané teorie    
\end{itemize}
    

\section*{In-class problems}


\begin{problem}
    
    Jsou následující formule variantami formule $(\forall x)(x<y \vee (\exists z)(z=y \wedge z\ne x))$?
    \begin{enumerate}[(a)]
        \item $(\forall z)(z<y \vee (\exists z)(z=y \wedge z\ne z))$
        \item $(\forall y)(y<y \vee (\exists z)(z=y \wedge z\ne y))$
        \item $(\forall u)(u<y \vee (\exists z)(z=y \wedge z\ne u))$
    \end{enumerate}

    \begin{solution}
        Označme $\psi=(x<y \vee (\exists z)(z=y \wedge z\ne x))$, formule je tedy $(\forall x)\psi$.

        \begin{enumerate}[(a)]
            \item Ne, $z$ není substituovatelná za $x$ do $\psi$: vznikl by nový vázaný výskyt.
            \item Ne, $y$ má volný výskyt v $\psi$.
            \item Ano, $u$ je nová proměnná: v takovém případě lze variantu udělat vždy.
        \end{enumerate}        
        
    \end{solution}

\end{problem}


\begin{problem}

    Mějme strukturu $\mathcal{A}=(\{a,b,c,d\};\vartriangleright^{A})$ v jazyce s jediným binárním relačním symbolem $\vartriangleright$, kde $\vartriangleright^{A}=\{(a,c), (b,c), (c,c), (c,d)\}$. 
    \begin{enumerate}[I.]
        \item Které z následujících formulí jsou pravdivé v $\mathcal A$? 
        \item Pro každou z nich najděte strukturu $\mathcal{B}$ (existuje-li) takovou, že $\mathcal{B}\models \varphi$ právě když $\mathcal{A}\not\models \varphi$.
    \end{enumerate}    
    \begin{enumerate}[(a)]
       \item $x \vartriangleright y$
       \item $(\exists x)(\forall y)(y \vartriangleright x)$
       \item $(\exists x)(\forall y)((y \vartriangleright x) \to (x \vartriangleright x))$
       \item $(\forall x)(\forall y)(\exists z)((x \vartriangleright z)\wedge(z \vartriangleright y))$
       \item $(\forall x)(\exists y)((x \vartriangleright z)\vee(z \vartriangleright y))$
    \end{enumerate}

    \begin{solution}

        Struktury si můžeme představit jako orientované hrany.
        \begin{enumerate}[(a)]
            \item I. Ne, intuitivně formule vyjadřuje, že relace  $\vartriangleright^\mathcal A$ obsahuje všechny dvojice (hrany), z definice $\mathrm{PH}^\mathcal A(x \vartriangleright y)[e]=0$ např. pro $e(x)=a$, $e(y)=a$.\\            
            II. Např. $\mathcal B_0=(\{0\};\vartriangleright^{\mathcal B_0})$ s $\vartriangleright^{\mathcal B_0}=\{(0,0)\}$.
            \item I. Ne, intuitivně graf nemá stok, z definice: $\mathrm{PH}^\mathcal A(\varphi)=\max_{u\in A}\mathrm{PH}^\mathcal A((\forall y)(y \vartriangleright x))[e(x/u)]=\max_{u\in A}\min_{v\in A}\mathrm{PH}^\mathcal A(y \vartriangleright x)[e(x/u,y/v)]=0$, např. pro $u=a$ můžeme vzít $v=a$.\\
            II. Např. $\mathcal B_0$ jako výše.
            \item I. Ano ($x$ ohodnoťte např. prvkem $a$), antecedent není splněn pro žádné ohodnocení $y$, tedy implikace je vždy splněna.\\
            II. Např. $\mathcal B_1=(\{0,1\};\vartriangleright^{\mathcal B_1})$ s $\vartriangleright^{\mathcal B_1}=\{(0,1)\}$.
            \item I. Ne, II: Např. $\mathcal B_0$.
            \item I. Ne, II: Např. $\mathcal B_0$.  
        \end{enumerate}
        
    \end{solution}

\end{problem}


\begin{problem}

    Dokažte (sémanticky) nebo najděte protipříklad: Pro každou strukturu $\mathcal{A}$, formuli $\varphi$, a sentenci $\psi$,
    \begin{enumerate}[(a)]
    \item $\mathcal{A}\models (\psi \to (\exists x)\varphi) \Leftrightarrow \mathcal{A}\models (\exists x)(\psi \to \varphi)$
    \item $\mathcal{A}\models (\psi \to (\forall x)\varphi) \Leftrightarrow \mathcal{A}\models (\forall x)(\psi \to \varphi)$
    \item $\mathcal{A}\models ((\exists x)\varphi \to \psi) \Leftrightarrow \mathcal{A}\models (\forall x)(\varphi \to \psi)$
    \item $\mathcal{A}\models ((\forall x)\varphi \to \psi ) \Leftrightarrow \mathcal{A}\models (\exists x)(\varphi \to \psi)$
    \end{enumerate}
    Platí to i pro každou formuli $\psi$ s volnou proměnnou $x$? A pro každou formuli $\psi$ ve které $x$ není volná?

    \begin{solution}

        (a) Bylo by jednodušší využít tablo metodu, ale chceme procvičit sémantický důkaz. Intuitivně, protože je $\psi$ sentence, ohodnocení $x$ nehraje roli při výpočtu pravdivostní hodnoty $\psi$, tedy ekvivalence platí. Počítejme z definic: $\mathcal{A}\models (\psi \to (\exists x)\varphi)$ platí právě když to platí při každém ohodnocení $e:\mathrm{Var}\to\mathcal A$. Počítejme pravdivostní hodnotu. Využijeme faktu, že $f_\to(a,b)=\max(1-a,b)$:
            \begin{align*}
                &\mathrm{PH}^\mathcal A(\psi \to (\exists x)\varphi)[e]\\
                =&f_\to(\mathrm{PH}^\mathcal A(\psi)[e], \mathrm{PH}^\mathcal A((\exists x)\varphi)[e])\\
                =&\max(1-\mathrm{PH}^\mathcal A(\psi)[e], \mathrm{PH}^\mathcal A((\exists x)\varphi)[e])\\
                =&\max(1-\mathrm{PH}^\mathcal A(\psi)[e], \max_{a\in A}\mathrm{PH}^\mathcal A(\varphi)[e(x/a)])\\                
            \end{align*}
            Podobně pro formuli na pravé straně:
            \begin{align*}
                &\mathrm{PH}^\mathcal A((\exists x)(\psi \to \varphi))[e]\\
                =&\max_{a\in A}\mathrm{PH}^\mathcal A(\psi \to \varphi)[e(x/a)]\\
                =&\max_{a\in A}(\max(1-\mathrm{PH}^\mathcal A(\psi)[e(x/a)], \mathrm{PH}^\mathcal A(\varphi)[e(x/a)]))
            \end{align*}
            Protože $\psi$ je sentence, neobsahuje volný výskyt proměnné $x$, tedy $\mathrm{PH}^\mathcal A(\psi)[e(x/a)]=\mathrm{PH}^\mathcal A(\psi)[e]$. Z toho vidíme, že:
            \begin{align*}
                =&\max_{a\in A}(\max(1-\mathrm{PH}^\mathcal A(\psi)[e], \mathrm{PH}^\mathcal A(\varphi)[e(x/a)]))\\
                =&\max(1-\mathrm{PH}^\mathcal A(\psi)[e], \max_{a\in A}(\mathrm{PH}^\mathcal A(\varphi)[e(x/a)]))
            \end{align*}
            Obě pravdivostní hodnoty jsou stejné, tedy ekvivalence platí. Pro tento argument stačí, aby $x$ nebyla volná v $\psi$. 
            
            Pokud je $x$ volná v $\psi$, tak ekvivalence neplatí. Např. v jazyce $L=\langle c\rangle$ s rovností, kde $c$ je konstantní symbol:
            \begin{itemize}
                \item $\varphi$ je $\neg x=x$,
                \item $\psi$ je $x=c$,
                \item $\mathcal A=(\{0,1\};0)$ (tj. $c^\mathcal A=0$).
            \end{itemize}
            Máme $\mathcal A\not\models (x=c\to (\exists x) \neg x=x)$, protože to neplatí při ohodnocení $e(x)=0$. Ale $\mathcal A\models(\exists x)(x=c\to \neg x=x)$, protože $x$ lze ohodnotit prvkem $1$, a antecendent není splněn.

        (b), (c), (d) se vyřeší obdobně. 
                    
    \end{solution}

\end{problem}


\begin{problem}

    Rozhodněte, zda je $T$ (v jazyce $L = \langle U, f \rangle$ s rovností) kompletní. Existují-li, napište dva elementárně neekvivalentní modely, a dvě neekviv. kompletní jednoduché extenze:
    \begin{enumerate}[(a)]
        \item  $T = \{U(f(x)),\ \neg x=y,\ x=y\vee x=z\vee y=z\}$
        \item $T = \{U(f(x)),\ \neg (\forall x)(\forall y)x=y,\ x=y\vee x=z\vee y=z\}$
        \item  $T = \{U(f(x)),\ \neg x=f(x),\ \neg (\forall x)(\forall y)x=y,\ x=y\vee x=z\vee y=z\}$
        \item  $T = \{U(f(x)),\ \neg (\forall x) x=f(x),\ \neg (\forall x)(\forall y)x=y,\ x=y\vee x=z\vee y=z\}$
    \end{enumerate}

    \begin{solution}
        \begin{enumerate}[(a)]
            \item Pozor, tato teorie je sporná. Uvědomte si, že $\neg x=y$ je spor: neplatí v žádném modelu, protože neplatí při ohodnocení $e(x)=a,e(y)=a$ pro libovolný prvek $a\in A$. (Je ekvivalentní svému generálnímu uzávěru $(\forall x)(\forall y)\neg x=y$.) Sporná teorie není kompletní, z definice, a všechny její extenze jsou také sporné, tedy nemá žádnou kompletní jednoduchou extenzi.
            \item Není kompletní. Neformálně, $T$ říká, že model má právě dva prvky, a výstupy $f^\mathcal A$ musí být uvnitř $U^\mathcal A$. Z toho víme, že $U^\mathcal A\neq\emptyset$. Je-li jednoprvková, máme jediný model (až na izomorfismus), je-li dvouprvková, máme celkem tři navzájem neizomorfní (a také navzájem elementárně neekvivalentní) modely (kde $f^\mathcal A$ nemá pevný bod, má jeden pevný bod, nebo má dva pevné body, tj. je to identita):
            \begin{itemize}
                \item $\mathcal A_1=(\{0,1\};U^\mathcal A_1,f^\mathcal A_1)$ kde $U^\mathcal A_1=\{0\}$ a $f^\mathcal A_1=\{(0,0),(1,0)\}$, tj. $f^\mathcal A_1(0)=0$, $f^\mathcal A_1(1)=0$
                \item $\mathcal A_2=(\{0,1\};\{0,1\},\{(0,1),(1,0)\})$,
                \item $\mathcal A_3=(\{0,1\};\{0,1\},\{(0,0),(1,0)\})$,
                \item $\mathcal A_4=(\{0,1\};\{0,1\},\{(0,0),(1,1)\})$.
            \end{itemize} 
            (Nakreslete si obrázky!) Odpovídající kompletní jednoduché extenze lze zapsat jako $\mathrm{Th}(\mathcal A_i)$, kde $i=1,2,3,4$. Nebo:
            \begin{itemize}
                \item $T_1=T\cup\{\neg (\forall x) U(x)\}$,
                \item $T_2=T\cup\{U(x),\neg f(x)=x\}$,
                \item $T_3=T\cup\{U(x),(\exists x)f(x)=x,(\exists x)\neg f(x)=x\}$,
                \item $T_4=T\cup\{U(x),f(x)=x\}$.
            \end{itemize}
            \item Obdobně, vyjadřuje, že model má právě dva prvky, a $f$ nemá žádný pevný bod. Je kompletní, jediný model až na izomorfismus je $\mathcal A_2$.
            \item Model má právě dva prvky, a $f$ má alespoň jeden pevný bod. Není kompletní, její modely jsou až na izomorfismus $\mathcal A_3$ a $\mathcal A_4$.
            

        \end{enumerate}
                    
    \end{solution}

\end{problem}
        
        
\section*{Extra practice}


\begin{problem}

    Určete volné a vázané výskyty proměnných v následujících formulích. Poté je převeďte na varianty, ve kterých nebudou proměnné s volným i vázaným výskytem zároveň.
    \begin{enumerate}[(a)]
        \item $(\exists x)(\forall y)P(y,z) \vee (y=0)$
        \item $(\exists x)(P(x) \wedge (\forall x)Q(x)) \vee (x=0)$
        \item $(\exists x)(x>y) \wedge (\exists y)(y>x)$
    \end{enumerate}

\end{problem}


\begin{problem}
    
    Označme $\varphi$ formuli $(\forall x)((x=z) \vee (\exists y)(f(x)=y) \vee (\forall z)(y=f(z)))$. Které z následujících termů jsou substituovatelné do $\varphi$?
    \begin{enumerate}[(a)]
        \item term $z$ za proměnnou $x$, term $y$ za proměnnou $x$,
        \item term $z$ za proměnnou $y$, term $g(f(y),w)$ za proměnnou $y$,
        \item term $x$ za proměnnou $z$, term $y$ za proměnnou $z$,
    \end{enumerate}

\end{problem}


\begin{problem}

    Jsou následující sentence pravdivé / lživé / nezávislé (v logice)?

    \begin{enumerate}[(a)]
        \item $(\exists x)(\forall y)(P(x) \vee \neg P(y))$
        \item $(\forall x)(P(x)\to Q(f(x))) \wedge (\forall x)P(x) \wedge (\exists x)\neg Q(x)$
        \item $(\forall x)(P(x) \vee Q(x)) \to ((\forall x)P(x) \vee (\forall x)Q(x))$
        \item $(\forall x)(P(x)\to Q(x)) \to ((\exists x)P(x)\to(\exists x)Q(x))$
        \item $(\exists x)(\forall y)P(x,y) \to (\forall y)(\exists x)P(x,y)$
    \end{enumerate}

\end{problem}


\begin{problem}
    
    Rozhodněte, zda následující platí pro každou formuli $\varphi$. Dokažte (sémanticky, z definic) nebo najděte protipříklad.
    \begin{enumerate}[(a)]
       \item $\varphi \models (\forall x)\varphi$
       \item $\models \varphi \to (\forall x)\varphi$
       \item $\varphi \models (\exists x)\varphi$
       \item $\models \varphi \to (\exists x)\varphi$
    \end{enumerate}

\end{problem}


\section*{For further thought}


\begin{problem}

    Buď $L=\langle +, -, 0\rangle$ jazyk teorie grup (s rovností). Teorie grup $T$ sestává z těchto axiomů:
    \begin{align*}
    x+(y+z)&=(x+y)+z\\
    0+x&=x=x+0\\
    x+(-x)&=0=(-x)+x
    \end{align*}
    Rozhodněte, zda jsou následující formule pravdivé / lživé / nezávislé v $T$. Zdůvodněte.
    \begin{enumerate}[(a)]
        \item $x+y=y+x$
        \item $x+y=x\ \rightarrow\ y=0$
        \item $x+y=0\ \rightarrow\ y=-x$
        \item $-(x+y)=(-y)+(-x)$
    \end{enumerate}

\end{problem}



