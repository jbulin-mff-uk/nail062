\section*{NAIL062 V\&P Logika: 10. sada příkladů -- Rezoluční metoda v PL}
% po 5. přednášce


\subsection*{Cíle výuky:} Po absolvování cvičení student

    \begin{itemize}\setlength{\itemsep}{0pt}
        \item rozumí pojmu unifikace, umí provádět Unifikační algoritmus
        \item zná potřebné pojmy z rezoluční metody v predikátové logice (rezoluční pravidlo, rezolventa, rezoluční důkaz/zamítnutí, rezoluční strom), umí je formálně definovat, uvést příklady, vysvětlit rozdíly oproti výrokové logice, 
        \item umí aplikovat rezoluční metodu k řešení daného problému (slovní úlohy, aj.), provést všechny potřebné kroky (převod do PNF, skolemizace, převod do CNF)
        \item umí sestrojit rezoluční zamítnutí dané (i nekonečné) CNF formule (existuje-li), a také nakreslit příslušný rezoluční strom, včetně uvedení použitých unifikací
        \item z rezolučního stromu umí sestrojit nesplnitelnou konjunkci základních instancí axiomů
        \item zná pojem LI-rezoluce, umí najít LI-zamítnutí dané teorie (existuje-li)
        \item seznámil se s vybranými pojmy z teorie modelů
    \end{itemize}
    

\section*{Příklady na cvičení}


\begin{problem} 
    
    \emph{Každý holič holí všechny, kdo neholí sami sebe. Žádný holič neholí nikoho, kdo holí sám sebe.} Formalizujte v predikátové logice a dokažte rezolucí, že: \emph{Neexistují žádní holiči.}

    \begin{solution}

        Nejprve zvolíme vhodný jazyk. V textu identifikujeme vlastnost objektů ``$x$ je holič'' a vztah dvou objektů ``(kdo) $x$ holí (koho) $y$''. Použijeme jazyk $L=\langle B, S\rangle$ bez rovnosti, kde $B$ je unární relační symbol, $B(x)$ má význam ``$x$ je holič (barber)'', $S$ je binární relační symbol, $S(x,y)$ znamená ``$x$ holí (shaves) $y$''. 
        
        V tomto jazyce formalizujeme tvrzení ze zadání:
        \begin{itemize}
            \item Každý holič holí všechny, kdo neholí sami sebe: 
            $$
            \varphi_1\ =\ (\forall x)(B(x)\limplies (\forall y)(\neg S(y,y)\limplies S(x,y)))
            $$
            \item Žádný holič neholí nikoho, kdo holí sám sebe: 
            $$
            \varphi_2\ =\ \neg (\exists x)(B(x) \land (\exists y)(S(x,y)\land S(y,y)))
            $$
            \item Neexistují žádní holiči:
            $$
            \psi\ =\ \neg (\exists x)B(x)
            $$
        \end{itemize}
        Naším cílem je ukázat, že v teorii $T=\{\varphi_1,\varphi_2\}$ platí sentence $\psi$. Dokazujeme sporem, vyjdeme tedy z teorie $T\cup\{\neg\psi\}=\{\varphi_1,\varphi_2,\neg\psi\}$. Pomocí skolemizace k ní najdeme ekvisplnitelnou CNF formuli $S$. Najdeme rezoluční zamítnutí $S$, čímž ukážemem že $S$ a tedy i $T\cup\{\neg\psi\}$ je nesplnitelná.

        Převedeme do PNF, skolemizujeme, odstraníme univerzální kvantifikátory, a převedeme do CNF:
        \begin{itemize}
            \item $\varphi_1\ \rightsquigarrow\ B(x)\limplies (\neg S(y,y)\limplies S(x,y))\ \sim \ \neg B(x)\lor S(y,y)\lor S(x,y)$
            \item $\varphi_1\ \rightsquigarrow\ \neg(B(x)\land S(x,y)\land S(y,y))\ \sim\ \neg B(x)\lor \neg S(x,y)\lor \neg S(y,y)$
            \item $\neg\psi\rightsquigarrow\ B(c)$ (kde $c$ je nový konstantní symbol)
        \end{itemize}
        Před skolemizací se ujistěte, že máte sentence. A nezapomeňte, že musíme skolemizovat sentenci $\neg\psi$, ne $\psi$. (Negace skolemovy varianty není ekvisplnitelná s negací původní formule!). V množinovém zápisu:
        $$
        S = \{\{\neg B(x), S(y,y), S(x,y)\},\{\neg B(x), \neg S(x,y), \neg S(y,y)\},\{B(c)\}\}
        $$
        Rezoluční zamítnutí:
        \begin{align*}
            &\{B(c)\},\{\neg B(x), S(y,y), S(x,y)\},\{S(y,y),S(c,y)\},\{\neg B(x), \neg S(x,y'), \neg S(y',y')\},\\
            &\{\neg S(c,y'), \neg S(y',y')\},\square    
        \end{align*}
        První dvě klauzule jsou z $S$, třetí jejich rezolventa za použití unifikace $\{x/c\}$. Čtvrtá klauzule je variantou klauzule z $S$, proměnnou $y$ jsme přejmenovali na $y'$, abychom dodrželi technickou podmínku o disjunktních množinách proměnných v rezolvovaných klauzulích. Pátá klauzule je rezolventou první a čtvrté za použití unifikace $\{x/c\}$. Poslední, prázdná klauzule $\square$ je rezolventou z 3. a 5. klauzule, unifikace $\{y/c,y'/c\}$.

        Typicky ale zamítnutí zakreslíme rezolučním stromem, naznačíme i použité unifikace:

        TODO

    \end{solution}

\end{problem}


\begin{problem}

    Jsou dána následující tvrzení o~proběhlém genetickém experimentu:
    \begin{enumerate}[(i)]\it
        \item Každá ovce byla buď porozena jinou ovcí, nebo naklonována (avšak nikoli oboje zároveň).
        \item Žádná naklonovaná ovce neporodila.
    \end{enumerate}
    Chceme ukázat rezolucí, že pak: {\it (iii) Pokud ovce porodila, byla sama porozena.} Konkrétně:
    \begin{enumerate}[(a)]
        \item Uvedená tvrzení vyjádřete sentencemi $\varphi_1$, $\varphi_2$, $\varphi_3$ v jazyce $L=\langle P,K\rangle$ bez rovnosti ($P$ je binární a $K$ unární relační symbol).
        \item S využitím skolemizace těchto sentencí nebo jejich negací sestrojte množinu klauzulí $S$ (může být ve větším jazyce), která je nesplnitelná, právě když  $\{\varphi_1, \varphi_2\} \models \varphi_3$. %Zapište ji v množinové reprezentaci.
        \item Najděte rezoluční zamítnutí $S$, nakreslete rezoluční strom s použitými unifikacemi.
        \item Má $S$ LI-zamítnutí?
    \end{enumerate}

    \begin{solution}
                    
    \end{solution}

\end{problem}


\begin{problem}

    Nechť $T=\{\neg(\exists x) R(x),\ (\exists x)(\forall y)(P(x,y)\to P(y,x)),\ (\forall x)((\exists y)(P(x,y)\wedge P(y,x))\to R(x)),\ (\forall x)(\exists y)P(x,y)\}$ je teorie jazyka $L=\langle P,R\rangle$ bez rovnosti.

    \begin{enumerate}[(a)]
        \item Skolemizací nalezněte k $T$ otevřenou ekvisplnitelnou teorii $T'$.
        \item Převeďte $T'$ na ekvivalentní teorii $S$ v CNF. Zapište $S$ v množinové reprezentaci.
        \item Nalezněte rezoluční zamítnutí teorie $S$. U každého kroku uveďte použitou unifikaci.
        \item Nalezněte konjunkci základních instancí axiomů $S$, která je nesplnitelná. {\it Nápověda: využijte unifikace z (c).}       
    \end{enumerate}

    \begin{solution}
                    
    \end{solution}

\end{problem}

        
\section*{Další příklady k procvičení}


\begin{problem}
    Najděte rezoluční zamítnutí: 
    \begin{align*}
        S=\{
            &\{P(a,x,f(y)),P(a,z,f(h(b))),\neg Q(y,z)\},\
            \{\neg Q(h(b),w),H(w,a)\},\ 
            \{\neg H(v,a)\},\\
            &\{\neg P(a,w,f(h(b))),H(x,a)\},\
            \{P(a,u,f(h(u))),H(u,a),Q(h(b),b)\}            
        \}
    \end{align*}
   

\end{problem}


\begin{problem}

    Mějme jazyk $L=\langle <, j, h, s\rangle$ bez rovnosti, kde $j,h,q$ jsou konstantní symboly (`jablka/hrušky/švestky') a $x < y$ vyjadřuje, že {\it ``ovoce $y$ je lepší než ovoce $x$''}. Víme, že:
    \begin{enumerate}[(i)]\it
        \item Relace ``být lepší'' je ostré částečné uspořádání (ireflexivní, asymetrická, tranzitivní).
        \item Hrušky jsou lepší než jablka.
    \end{enumerate}
    Dokažte rezolucí, že \emph{(iii) Jsou-li švestky lepší než hrušky, nejsou jablka lepší než švestky.}

    \begin{enumerate}[(a)]
    \item Tvrzení $(i)$, $(ii)$, $(iii)$ vyjádřete jako otevřené formule v jazyce $L$.
    \item Pomocí těchto formulí najděte CNF formuli $S$, která je nesplnitelná, právě když z $(i)$, $(ii)$ vyplývá $(iii)$. Napište $S$ v množinové reprezentaci.
    \item Rezolucí dokažte, že $S$ není splnitelná. Rezoluční zamítnutí znázorněte rezolučním stromem. U každého kroku uveďte použitou unifikaci. {\it Nápověda: stačí čtyři rezoluční kroky.}
    \item Nalezněte konjunkci základních instancí axiomů $S$, která je nesplnitelná.
    \item Je $S$ zamítnutelná LI-rezolucí?
    \end{enumerate}

\end{problem}


\begin{problem}

    Buď $T=\{\varphi\}$ teorie jazyka $L=\langle U, c \rangle$ s rovností, kde $U$ je unární relační symbol, $c$ konstantní symbol, a axiom $\varphi$ vyjadřuje \emph{``Existuje alespoň $5$ prvků, pro které platí $U(x)$.''}
    \begin{enumerate}[(a)]
        \item Najděte dvě neekvivalentní jednoduché kompletní extenze $T$.
        \item Je teorie $T$ otevřeně axiomatizovatelná? Uveďte zdůvodnění.
    \end{enumerate}

\end{problem}


\begin{problem}

    Nechť $T = \{U(x) \to U(f(x)), (\exists x)U(x), \neg (f(x) = x), \varphi\}$ je teorie v jazyce $L = \langle U, f \rangle$ s rovností, kde $U$ je unární relační symbol, $f$ je unární funkční symbol a $\varphi$ vyjadřuje, že ``existují maximálně 4 prvky''.
    \begin{enumerate}[(a)]
        \item Je teorie $T$ extenzí teorie $S = \{ (\exists x)(\exists y)(\neg x = y \land U(x) \land U(y)), \varphi \}$ v jazyce $L' = \langle U \rangle$? Je konzervativní extenzí? Zdůvodněte.
        \item Je teorie $T$ otevřeně axiomatizovatelná? Zdůvodněte.    
    \end{enumerate}
\end{problem}


\begin{problem}

    Buď $T=\{(\forall x)(\exists y) S(y)=x,\ S(x)=S(y)\to x=y\}$ teorie v~jazyce $L=\langle S\rangle$ s~rovností, kde $S$ je unární funkční symbol.
    \begin{enumerate}[(a)]
        \item Nalezněte extenzi $T'$ teorie $T$ o definici nového unárního funkčního symbolu $P$ takovou, že $T' \models S(S(x))=y \leftrightarrow P(P(y))=x$.
        \item Je teorie $T'$ otevřeně axiomatizovatelná? Uveďte zdůvodnění.
    \end{enumerate}

\end{problem} 


\begin{problem}

    Nechť $T$ je extenze teorie $DeLO^-$ (tj. hustých lineárních uspořádání s minimálním prvkem a bez maximálního prvku) o nový axiom $c \le d$ v jazyce $L=\langle \le,c,d\rangle$ s rovností, kde $c$, $d$ jsou nové konstantní symboly.
    \begin{enumerate}[(a)]
        \item Jsou sentence $(\exists x)(x\le d \wedge x \ne d)$ a $(\forall x)(x \le d)$ pravdivé / lživé / nezávislé v $T$?
        \item Napište dvě neekvivalentní jednoduché kompletní extenze teorie $T$.
    \end{enumerate}
    
\end{problem}


\begin{problem}

    Mějme následující graf.
    \smallskip
    
    \begin{minipage}{.72\textwidth}
        \begin{enumerate}[(a)]
            \item Najděte všechny automorfismy.
            \item Které podmnožiny množiny vrcholů $V$ jsou definovatelné? Uveďte definující formule. {\it (Nápověda: Využijte (a).)}
            \item Které binární relace na $V$ jsou definovatelné?
        \end{enumerate}
    \end{minipage}%
    \begin{minipage}{.28\textwidth}        
        \vspace{-12pt}\hspace{12pt}
        \begin{tikzpicture}[every node/.style={circle,fill=blue!10,draw,minimum size=0.5cm,node distance=1.2cm}]
            \node (1) {$1$};
            \node[right of=1] (2) {$2$};
            \node[below of=2] (3) {$3$};
            \node[left of=3] (4) {$4$};
            \path[draw] (1) -- (2) -- (3) -- (4) -- (1) -- (3);
            \node[right of=3] (5) {$5$};
            \path[draw] (2) -- (5) -- (3);
        \end{tikzpicture}        
    \end{minipage}%   

\end{problem}


\section*{K zamyšlení}


\begin{problem}

    Buď $T=\{(\forall x)(\exists y) S(y)=x,\ S(x)=S(y)\to x=y\}$ teorie v~jazyce $L=\langle S\rangle$ s~rovností, kde $S$ je unární funkční symbol.
    \begin{enumerate}[(a)]
        \item Buď $\mathcal{R}=\langle\mathbb{R},S\rangle$, kde $S(r)=r+1$ pro $r\in\mathbb{R}$. Pro která $r\in\mathbb{R}$ je množina $\{r\}$ definovatelná v~$\mathcal{R}$ z~parametru $0$?
        \item Je teorie $T$ otevřeně axiomatizovatelná? Uveďte zdůvodnění.
        \item Je extenze $T'$ teorie $T$ o~axiom $S(x)=x$ $\omega$-kategorická teorie? Je $T'$ kompletní?
        \item Pro která $0<n\in\mathbb{N}$ existuje $L$-struktura $\mathcal{B}$ velikosti $n$ elementárně ekvivalentní s~$\mathcal{R}$? Existuje spočetná struktura $\mathcal{B}$ elementárně ekvivalentní s~$\mathcal{R}$?
    \end{enumerate}

\end{problem}


% \begin{problem}

%     Známe následující informace o zadávání zakázek:
%     \begin{enumerate}[(i)] \it
%         \item Každý úředník, který je odpovědný za nějakou zakázku a vezme od nějaké společnosti úplatek, je kriminálník.
%         \item Zakázku vyhraje pouze společnost, která podplatí všechny úředníky odpovědné za tuto zakázku.
%         \item Pan Lubor je úředník.
%         \item Nějaká společnost vyhrála nějakou zakázku, za kterou je pan Lubor odpovědný.
%     \end{enumerate}
%     Pomocí rezoluce dokažte, že: {\it (v) Pan Lubor je kriminálník.}
%     \begin{enumerate}[(a)]
%         \item Uvedená tvrzení vyjádřete \underline{sentencemi} $\varphi_1, \dots, \varphi_5$ v jazyce $L=\langle U, Z, S, K, P, V, O, l \rangle$ bez rovnosti, kde $U, Z, S$ a $K$ jsou unární relační symboly a $U(x), Z(x), S(x), K(x)$ znamenají (po řadě) ``$x$ je úředník / zakázka / společnost / kriminálník'', $P, V, O$ jsou binární relační symboly, kde $P(x,y), V(x,y), O(x,y)$ značí (po řadě) ``$x$ podplatil $y$'', ``$x$ vyhrál $y$'' a ``$x$ je odpovědný za $y$'' a $l$ je konstanta označující pana Lubora.
%         \item Pomocí skolemizace předchozích formulí nalezněte otevřenou teorii $T$ (případně ve větším jazyce), která je nesplnitelná, právě když  $\{\varphi_1, \varphi_2, \varphi_3, \varphi_4\} \models \varphi_5$.
%         \item Převedením axiomů $T$ do CNF nalezněte teorii $T'$ ekvivalentní $T$ a axiomatizovanou klauzulemi. Napište $T'$ v množinové reprezentaci.
%         \item Rezolucí dokažte, že $T'$ není splnitelná. Rezoluční zamítnutí znázorněte rezolučním stromem. U každého kroku uveďte použitou unifikaci.
%         \item Nalezněte konjunkci základních instancí axiomů $T'$, která je nesplnitelná.
%     \end{enumerate}

% \end{problem}

\end{document}


